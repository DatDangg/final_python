{% extends 'base.html' %}

{% block title %}Dashboard Overview{% endblock %}

{% block content %}
{% load static %}
<h1>Dashboard Overview</h1>

<div class="dashboard-stats">
    <div class="stat-box">
        <h3>Total Delivered Orders</h3>
        <p>{{ total_orders }}</p>
    </div>
    <div class="stat-box">
        <h3>Total Sales</h3>
        <p>${{ total_sales }}</p>
    </div>
    <div class="stat-box">
        <h3>Total Profit</h3>
        <p>${{ total_profit }}</p>
    </div>
</div>

<!-- <img id="moving-image" src="{% static 'images/lantern.png' %}" alt="Lantern">
<script>
    let img = document.getElementById("moving-image");
    let posX = 0;
    let posY = 0;
    let directionX = 1;
    let directionY = 1;
    function moveImage() {
        let containerWidth = window.innerWidth;
        let containerHeight = window.innerHeight;
        posX += directionX * 2; 
        posY += directionY * 2; 

        if (posX + img.offsetWidth > containerWidth || posX < 0) {
            directionX = -directionX;
        }
        if (posY + img.offsetHeight > containerHeight || posY < 0) {
            directionY = -directionY;
        }

        img.style.transform = `translate(${posX}px, ${posY}px)`;
        requestAnimationFrame(moveImage);
    }
    moveImage();
</script> -->

<div class="chart-container">
    <canvas id="salesChart"></canvas>
</div>
{{ sales_data|json_script:"sales-data" }}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
<script>
    var salesData = JSON.parse(document.getElementById('sales-data').textContent);
    var ctx = document.getElementById('salesChart').getContext('2d');
    var chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: salesData.map(data => new Date(data.month).toLocaleString('en-US', { month: 'long', year: 'numeric' })),  
            datasets: [{
                label: 'Monthly Sales',
                data: salesData.map(data => data.sales),  
                backgroundColor: 'rgba(75, 192, 192, 0.2)', 
                borderColor: 'rgba(75, 192, 192, 1)',  
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true  
                }
            }
        }
    });
</script> 


{% endblock %}
