{% extends 'base.html' %}

{% block title %}Product List{% endblock %}

{% block content %}
    <h1>Product List</h1>
    <a href="{% url 'add_product' %}" class="btn btn-primary mb-3">Thêm sản phẩm</a> <!-- Nút để chuyển tới trang Thêm sản phẩm -->
    <div class="table-responsive" style="max-height: 520px; overflow-y: auto;"> <!-- Thêm style inline để kiểm tra -->
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>STT</th>
                    <th>Tên sản phẩm</th>
                    <th>Thương hiệu</th>
                    <th>Danh mục</th>
                    <th>Biến thể (Màu, Dung lượng, Giá, Số lượng)</th>
                    <th>Chi tiết</th>
                    <th>Sửa</th>
                    <th>Xóa</th>
                </tr>
            </thead>
            <tbody>
                {% for item in product_data %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ item.product.title }}</td>
                    <td>{{ item.product.brand }}</td>
                    <td>{{ item.product.category.name }}</td>
                    <td>
                        {% for variant in item.variants %}
                            Màu: {{ variant.color }} - Dung lượng: {{ variant.storage }} - Giá: {{ variant.listed_price }} - Số lượng: {{ variant.quantity }} <br>
                        {% endfor %}
                    </td>
                    <td>
                        {% if item.details %}
                            {% if item.product.category.name == "Smart Phones" %}
                                CPU: {{ item.details.cpu }}, Camera chính: {{ item.details.main_camera }}<br>
                                Pin: {{ item.details.battery_capacity }}, Màn hình: {{ item.details.screen_size }}<br>
                            {% elif item.product.category.name == "Computers" %}
                                Bộ xử lý: {{ item.details.processor }}, RAM: {{ item.details.ram }}<br>
                                Card đồ họa: {{ item.details.graphics_card }}, Pin: {{ item.details.battery_life }}<br>
                            {% elif item.product.category.name == "Smart Watches" %}
                                Loại dây: {{ item.details.strap_type }}, Màn hình: {{ item.details.screen_size }}<br>
                                Chống nước: {{ item.details.water_resistance }}, Pin: {{ item.details.battery_capacity }}<br>
                            {% elif item.product.category.name == "Headphones" %}
                                Không dây: {{ item.details.wireless }}, Thời lượng pin: {{ item.details.battery_life }}<br>
                                Khử tiếng ồn: {{ item.details.noise_cancellation }}<br>
                            {% endif %}
                        {% else %}
                            Không có thông tin chi tiết
                        {% endif %}
                    </td>
                    <!-- Include both product_id and variant_id in the URL -->
                    <td>
                        {% for variant in item.variants %}
                            <a href="{% url 'edit_product' item.product.id variant.id %}">Sửa</a><br>
                        {% endfor %}
                    </td>
                    <td><a href="{% url 'delete_product' item.product.id %}" class="text-danger">Xóa</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
    </div>
{% endblock %}
